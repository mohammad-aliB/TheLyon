<html>
<head>
<style type="text/css">
    table{
        border-collapse: collapse;
    }
    td, th {
        border: 1px solid #dddddd;
        text-align: left;
        /* padding: 8px; */
        margin: 0;
        padding:0;
        width: 100px;
    }
    ul{
        min-height:100px;
        list-style:none;
        padding:0;
    }
    .number{    
        text-align: right;
        background-color: #eaeaea;
        width: 100%;
        display: block;
    }
    .mobile-number{
        display:none;
    }
    .event-text {
        position: relative;
        display: inline-block;
        padding-left:3px;
    }
    .event-text:hover{
        border-left:1px solid red;
    }
    .event-text .hover-text{
        visibility: hidden;
        width: 200px;
        background-color: white;
        border: 1px solid black;
        color: grey;
        padding: 5px 0;
        position: absolute;
        z-index: 1;
        top: -5px;
        left: 110%;
    }
    .event-text .hover-text span{
        margin:10px;
        display: block;
    }
    .event-text:hover .hover-text {
        visibility: visible;
    }
    #popup{
        position: fixed;
        width: 30%;
        height: 50%;
        /* margin: auto; */
        top: 25%;
        left: 35%;
        background-color: white;
        z-index: 2;
        padding: 10px;
        display:none;
        border:1px solid black;
    }
    #popup-background{
        position: fixed;
        /* width: 30%; */
        /* height: 50%; */
        /* margin: auto; */
        top: 0;
        left: 0;
        background-color: black;
        width: 100%;
        height: 100%;
        opacity: .3;
        display: none;
    }
    #popup-close{
        float: right;
        margin-left: 100%;
        /* border-radius: 0; */
        border: 1px solid black;
        background: white;
        cursor: pointer;
        height:30px;
        width:60px;
    }
    #popup-close:hover{
        border-bottom:2px solid black;
    }
    #popup-title{
        padding-top:31px;
        font-size:130%;
            /* margin: 0 auto; */
    width: 100%;
    text-align: center;
    }
    #popup-date{
        padding-top: 10px;
        padding-bottom:10px;
    }
    @media only screen and (max-device-width:680px) (orientation : landscape), (orientation : portrait)   {
        .mobile-number{
            display: block;
        }
        table{
            width:100%;
        }
        .hover-text{
            display:none;
        }
        tr:first-child{
            display:none;
        }
        td{
            display:block;
            width:90%;
            margin:0 auto;
        }
        .calendarPadding{
            display:none;
        }
    }
</style>
</head>
<body>
    <div id="calendar-title"><a href="/Calendar{{=it.lastMonth}}"><</a> {{=it.year}} {{=it.monthName||''}} <a href="/Calendar{{=it.nextMonth}}">></a></div>
<table>
    <tr>
        <th>Sunday</th>
        <th>Monday</th>
        <th>Tuesday</th>
        <th>Wednesday</th>
        <th>Thursday</th>
        <th>Friday</th>
        <th>Saturday</th>
    </tr>
    {{var dayOfWeekCount = 0;}}

    {{var eventsPointer=0;}}
{{? it.firstDay>0}}
<tr>
    {{for(x=0;x<it.firstDay;x++){ }}
        <td class="calendarPadding">
        <span class="number">&nbsp;</span>
        <ul>
        </ul>
        </td>
    {{ dayOfWeekCount++;} }}
{{?}}

    {{for(dayCount=1;dayCount<=it.numberOfDays;dayCount++){ }}
        {{? dayOfWeekCount==7}}
            </tr>
            {{dayOfWeekCount=0;}}
        {{?}}
        {{? dayOfWeekCount==0}}
            <tr>            
        {{?}}
        <td>
            <span class="number">{{=dayCount}}</span>
            <span class="mobile-number">{{=new Date(it.year+" "+it.monthName).toDateString()}}</span>
            <ul>
        {{ for(y=eventsPointer;y<it.events.length;y++){ }}
            {{? it.events[y].date.getDate()==dayCount}}
                {{eventsPointer=y;}}
                <li>
                    <span class="event-text" onclick="openPopup('{{=it.events[y].id}}');">
                        {{=it.events[y].name}}
                        <span class="hover-text">
                            <span>
                                <span class="hover-event-text" id="title-{{=it.events[y].id}}">{{=it.events[y].name||''}}</span> 
                                <span class="hover-event-date" id="date-{{=it.events[y].id}}">starts: {{=it.events[y].date.toString('dddd, d MMMM yyyy at HH:mm:ss').slice(0, 24)||''}}</span>
                                <span class="hover-event-description" id="description-{{=it.events[y].id}}">{{=it.events[y].description||''}}</span>
                            </span>
                        </span>
                    </span> 
                </li>
            {{?}}
        {{ } }}
        </ul>
        </td>
    {{dayOfWeekCount++;} }}
</table>
<div id="popup">
    <button id="popup-close" onclick="closePopup();">close</button>
    <div id="popup-title"></div>
    <div id="popup-date"></div>
    Description:<br>
    <div id="popup-description"></div>
</div>
<div id="popup-background" onclick="closePopup();"></div>
<script type="text/javascript">
    function openPopup(id){
        document.getElementById("popup-title").innerHTML=document.getElementById("title-"+id).innerHTML;
        document.getElementById("popup-date").innerHTML=document.getElementById("date-"+id).innerHTML;
        document.getElementById("popup-description").innerHTML=document.getElementById("description-"+id).innerHTML;
        document.getElementById("popup").style.display="block";
        document.getElementById("popup-background").style.display="block";
    }
    function closePopup(){
        document.getElementById("popup").style.display="none";
        document.getElementById("popup-background").style.display="none";
    }
{{=it.idToOpen}}
</script>
</body>
</html>